---
# local-config: referenced, but not emitted by kustomize
apiVersion: v1
kind: ConfigMap
metadata:
  name: network-values
  annotations:
    config.kubernetes.io/local-config: "true"
data:
  # nodes
  node_3:
    name: worker-0
    internalapi_ip: "2620:cf:cf:bbbb::10"
    tenant_ip: "2620:cf:cf:dddd::10"
    ctlplane_ip: "2620:cf:cf:aaaa::10"
    storage_ip: "2620:cf:cf:cccc::10"
    bgp_ip:
      - "2620:cf::100:64:0:10"
      - "2620:cf::100:65:0:10"
    bgp_peers:
      - "2620:cf::100:64:0:9"
      - "2620:cf::100:65:0:9"
    loopback_ip: 99.99.0.3
    loopback_ipv6: f00d:f00d:f00d:f00d:99:99:0:3
    routes:
      config:
        - destination: f00d:f00d:f00d:f00d:99:99:0:0/96
          next-hop-address: "2620:cf::100:64:0:9"
          next-hop-interface: enp8s0
          metric: 200
        - destination: f00d:f00d:f00d:f00d:99:99:0:0/96
          next-hop-address: "2620:cf::100:65:0:9"
          next-hop-interface: enp9s0
          metric: 201
  node_4:
    name: worker-1
    internalapi_ip: "2620:cf:cf:bbbb::11"
    tenant_ip: "2620:cf:cf:dddd::11"
    ctlplane_ip: "2620:cf:cf:aaaa::11"
    storage_ip: "2620:cf:cf:cccc::11"
    bgp_ip:
      - "2620:cf::100:64:1:10"
      - "2620:cf::100:65:1:10"
    bgp_peers:
      - "2620:cf::100:64:1:9"
      - "2620:cf::100:65:1:9"
    loopback_ip: 99.99.1.3
    loopback_ipv6: f00d:f00d:f00d:f00d:99:99:1:3
    routes:
      config:
        - destination: f00d:f00d:f00d:f00d:99:99:0:0/96
          next-hop-address: "2620:cf::100:64:1:9"
          next-hop-interface: enp8s0
          metric: 200
        - destination: f00d:f00d:f00d:f00d:99:99:0:0/96
          next-hop-address: "2620:cf::100:65:1:9"
          next-hop-interface: enp9s0
          metric: 201
  node_5:
    name: worker-2
    internalapi_ip: "2620:cf:cf:bbbb::12"
    tenant_ip: "2620:cf:cf:dddd::12"
    ctlplane_ip: "2620:cf:cf:aaaa::12"
    storage_ip: "2620:cf:cf:cccc::12"
    bgp_ip:
      - "2620:cf::100:64:2:10"
      - "2620:cf::100:65:2:10"
    bgp_peers:
      - "2620:cf::100:64:2:9"
      - "2620:cf::100:65:2:9"
    loopback_ip: 99.99.2.3
    loopback_ipv6: f00d:f00d:f00d:f00d:99:99:2:3
    routes:
      config:
        - destination: f00d:f00d:f00d:f00d:99:99:0:0/96
          next-hop-address: "2620:cf::100:64:2:9"
          next-hop-interface: enp8s0
          metric: 200
        - destination: f00d:f00d:f00d:f00d:99:99:0:0/96
          next-hop-address: "2620:cf::100:65:2:9"
          next-hop-interface: enp9s0
          metric: 201
  node_6:
    name: worker-3
    node_name: worker-3
    internalapi_ip: "2620:cf:cf:dddd::13"
    tenant_ip: "2620:cf:cf:eeee::13"
    ctlplane_ip: "2620:cf:cf:aaaa::13"
    bgp_ip:
      - 100.64.10.2
      - "2620:cf::100:64:10:2"
    bgp_peers:
      - 100.64.10.1
      - "2620:cf::100:64:10:1"
    loopback_ip: 99.99.10.2
    loopback_ipv6: f00d:f00d:f00d:f00d:99:99:10:4
    base_if: enp6s0
    routes:
      config:
        - destination: 192.168.133.0/24
          next-hop-address: 100.64.10.1
          next-hop-interface: enp8s0

  # networks
  ctlplane:
    dnsDomain: ctlplane.example.com
    subnets:
      - allocationRanges:
          - end: "2620:cf:cf:aaaa::120"
            start: "2620:cf:cf:aaaa::100"
          - end: "2620:cf:cf:aaaa::200"
            start: "2620:cf:cf:aaaa::150"
        cidr: "2620:cf:cf:aaaa::/64"
        gateway: "2620:cf:cf:aaaa::1"
        name: subnet1
        routes:
          - destination: "2620:cf:cf:aaab::/64"
            nexthop: "2620:cf:cf:aaaa::1"
          - destination: "2620:cf:cf:aaac::/64"
            nexthop: "2620:cf:cf:aaaa::1"
      - allocationRanges:
          - end: "2620:cf:cf:aaab::120"
            start: "2620:cf:cf:aaab::100"
          - end: "2620:cf:cf:aaab::200"
            start: "2620:cf:cf:aaab::150"
        cidr: "2620:cf:cf:aaab::/64"
        gateway: "2620:cf:cf:aaab::1"
        name: subnet2
        routes:
          - destination: "2620:cf:cf:aaaa::/64"
            nexthop: "2620:cf:cf:aaab::1"
          - destination: "2620:cf:cf:aaac::/64"
            nexthop: "2620:cf:cf:aaab::1"
      - allocationRanges:
          - end: "2620:cf:cf:aaac::120"
            start: "2620:cf:cf:aaac::100"
          - end: "2620:cf:cf:aaac::200"
            start: "2620:cf:cf:aaac::150"
        cidr: "2620:cf:cf:aaac::/64"
        gateway: "2620:cf:cf:aaac::1"
        name: subnet2
        routes:
          - destination: "2620:cf:cf:aaaa::/64"
            nexthop: "2620:cf:cf:aaac::1"
          - destination: "2620:cf:cf:aaab::/64"
            nexthop: "2620:cf:cf:aaac::1"
    prefix-length: 64
    iface: enp7s0
    mtu: 1500
    lb_addresses:
      - "2620:cf:cf:aaad::80-2620:cf:cf:aaad::90"
    endpoint_annotations:
      metallb.universe.tf/address-pool: ctlplane
      metallb.universe.tf/allow-shared-ip: ctlplane
      metallb.universe.tf/loadBalancerIPs: "2620:cf:cf:aaad::80"
    net-attach-def: |
      {
        "cniVersion": "0.3.1",
        "name": "ctlplane",
        "type": "bridge",
        "bridge": "ospbr",
        "isDefaultGateway": true,
        "forceAddress": false,
        "ipMasq": true,
        "hairpinMode": true,
        "ipam": {
          "type": "whereabouts",
          "range": "2620:cf:cf:aaae::0/64",
          "range_start": "2620:cf:cf:aaae::30",
          "range_end": "2620:cf:cf:aaae::70"
        }
      }

  internalapi:
    dnsDomain: internalapi.example.com
    subnets:
      - allocationRanges:
          - end: "2620:cf:cf:bbbb::250"
            start: "2620:cf:cf:bbbb::100"
        cidr: "2620:cf:cf:bbbb::0/64"
        name: subnet1
        vlan: 20
    mtu: 1500
    prefix-length: 64
    iface: internalapi
    vlan: 20
    base_iface: enp7s0
    lb_addresses:
      - "2620:cf:cf:bbbb::80-2620:cf:cf:bbbb::90"
    endpoint_annotations:
      metallb.universe.tf/address-pool: internalapi
      metallb.universe.tf/allow-shared-ip: internalapi
      metallb.universe.tf/loadBalancerIPs: "2620:cf:cf:bbbb::80"
    net-attach-def: |
      {
        "cniVersion": "0.3.1",
        "name": "internalapi",
        "type": "bridge",
        "bridge": "internalapi",
        "isDefaultGateway": true,
        "forceAddress": false,
        "ipMasq": true,
        "hairpinMode": true,
        "ipam": {
          "type": "whereabouts",
          "range": "2620:cf:cf:bbbb::0/64",
          "range_start": "2620:cf:cf:bbbb::30",
          "range_end": "2620:cf:cf:bbbb::70"
        }
      }

  storage:
    dnsDomain: storage.example.com
    subnets:
      - allocationRanges:
          - end: "2620:cf:cf:cccc::250"
            start: "2620:cf:cf:cccc::100"
        cidr: "2620:cf:cf:cccc::0/64"
        name: subnet1
        vlan: 21
    mtu: 1500
    prefix-length: 64
    iface: storage
    vlan: 21
    base_iface: enp7s0
    lb_addresses:
      - "2620:cf:cf:cccc::80-2620:cf:cf:cccc::90"
    net-attach-def: |
      {
        "cniVersion": "0.3.1",
        "name": "storage",
        "type": "bridge",
        "bridge": "storage",
        "isDefaultGateway": true,
        "forceAddress": false,
        "ipMasq": true,
        "hairpinMode": true,
        "ipam": {
          "type": "whereabouts",
          "range": "2620:cf:cf:cccc::0/64",
          "range_start": "2620:cf:cf:cccc::30",
          "range_end": "2620:cf:cf:cccc::70"
        }
      }

  tenant:
    dnsDomain: tenant.example.com
    subnets:
      - allocationRanges:
          - end: "2620:cf:cf:dddd::250"
            start: "2620:cf:cf:dddd::100"
        cidr: "2620:cf:cf:dddd::0/64"
        name: subnet1
        vlan: 22
    mtu: 1500
    prefix-length: 64
    iface: tenant
    vlan: 22
    base_iface: enp7s0
    lb_addresses:
      - "2620:cf:cf:eeee::80-2620:cf:cf:dddd::90"
    net-attach-def: |
      {
        "cniVersion": "0.3.1",
        "name": "tenant",
        "type": "bridge",
        "bridge": "tenant",
        "isDefaultGateway": true,
        "forceAddress": false,
        "ipMasq": true,
        "hairpinMode": true,
        "ipam": {
          "type": "whereabouts",
          "range": "2620:cf:cf:dddd::0/64",
          "range_start": "2620:cf:cf:dddd::30",
          "range_end": "2620:cf:cf:dddd::70"
        }
      }
  octavia:  # TODO-edu - change to ipv6
    dnsDomain: octavia.openstack.lab
    mtu: 1500
    vlan: 23
    base_iface: enp7s0
    net-attach-def: |
      {
        "cniVersion": "0.3.1",
        "name": "octavia",
        "type": "bridge",
        "bridge": "octbr",
        "ipam": {
          "type": "whereabouts",
          "range": "172.23.0.0/24",
          "range_start": "172.23.0.30",
          "range_end": "172.23.0.70",
          "routes": [
            {
              "dst": "172.24.0.0/16",
              "gw": "172.23.0.150"
            }
          ]
        }
      }

  external:
    dnsDomain: external.example.com
    subnets:
      - allocationRanges:
          - end: "2620:cf:cf:cf::250"
            start: "2620:cf:cf:cf::100"
        cidr: "2620:cf:cf:cf::/64"
        gateway: "2620:cf:cf:cf::1"
        name: subnet1
    mtu: 1500

  bgp:
    prefix-length: 126
    prefix-length-worker-3: 24
    prefix-length-worker-3-ipv6: 64
    ifaces:
      - enp8s0
      - enp9s0
    asn: 64999
    peer_asn: 64999
    subnets:
      bgpnet0:
        - name: subnet0
          allocationRanges:
            - end: 2620:cf::100:64:0:6
              start: 2620:cf::100:64:0:1
          cidr: 2620:cf::100:64:0:0/125
          gateway: 2620:cf::100:64:0:1
          routes:
            - destination: ::/0
              nexthop: 2620:cf::100:64:0:1
        - name: subnet1
          allocationRanges:
            - end: 2620:cf::100:64:1:6
              start: 2620:cf::100:64:1:1
          cidr: 2620:cf::100:64:1:0/125
          gateway: 2620:cf::100:64:1:1
          routes:
            - destination: ::/0
              nexthop: 2620:cf::100:64:1:1
        - name: subnet2
          allocationRanges:
            - end: 2620:cf::100:64:2:6
              start: 2620:cf::100:64:2:1
          cidr: 2620:cf::100:64:2:0/125
          gateway: 2620:cf::100:64:2:1
          routes:
            - destination: ::/0
              nexthop: 2620:cf::100:64:2:1
      bgpnet0ipv4:
        - name: subnet0
          allocationRanges:
            - end: 100.64.0.6
              start: 100.64.0.1
          cidr: 100.64.0.0/29
          gateway: 100.64.0.1
          routes:
            - destination: 0.0.0.0/0
              nexthop: 100.64.0.1
        - name: subnet1
          allocationRanges:
            - end: 100.64.1.6
              start: 100.64.1.1
          cidr: 100.64.1.0/29
          gateway: 100.64.1.1
          routes:
            - destination: 0.0.0.0/0
              nexthop: 100.64.1.1
        - name: subnet2
          allocationRanges:
            - end: 100.64.2.6
              start: 100.64.2.1
          cidr: 100.64.2.0/29
          gateway: 100.64.2.1
          routes:
            - destination: 0.0.0.0/0
              nexthop: 100.64.2.1
      bgpnet1:
        - name: subnet0
          allocationRanges:
            - end: 2620:cf::100:65:0:6
              start: 2620:cf::100:65:0:1
          cidr: 2620:cf::100:65:0:0/125
          gateway: 2620:cf::100:65:0:1
          routes:
            - destination: ::/0
              nexthop: 2620:cf::100:65:0:1
        - name: subnet1
          allocationRanges:
            - end: 2620:cf::100:65:1:6
              start: 2620:cf::100:65:1:1
          cidr: 2620:cf::100:65:1:0/125
          gateway: 2620:cf::100:65:1:1
          routes:
            - destination: ::/0
              nexthop: 2620:cf::100:65:1:1
        - name: subnet2
          allocationRanges:
            - end: 2620:cf::100:65:2:6
              start: 2620:cf::100:65:2:1
          cidr: 2620:cf::100:65:2:0/125
          gateway: 2620:cf::100:65:2:1
          routes:
            - destination: ::/0
              nexthop: 2620:cf::100:65:2:1
      bgpnet1ipv4:
        - name: subnet0
          allocationRanges:
            - end: 100.65.0.6
              start: 100.65.0.1
          cidr: 100.65.0.0/29
          gateway: 100.65.0.1
          routes:
            - destination: 0.0.0.0/0
              nexthop: 100.65.0.1
        - name: subnet1
          allocationRanges:
            - end: 100.65.1.6
              start: 100.65.1.1
          cidr: 100.65.1.0/29
          gateway: 100.65.1.1
          routes:
            - destination: 0.0.0.0/0
              nexthop: 100.65.1.1
        - name: subnet2
          allocationRanges:
            - end: 100.65.2.6
              start: 100.65.2.1
          cidr: 100.65.2.0/29
          gateway: 100.65.2.1
          routes:
            - destination: 0.0.0.0/0
              nexthop: 100.65.2.1
      bgpmainnet:
        - name: subnet0
          cidr: 99.99.0.0/28
          allocationRanges:
            - end: 99.99.0.14
              start: 99.99.0.2
        - name: subnet1
          cidr: 99.99.1.0/28
          allocationRanges:
            - end: 99.99.1.14
              start: 99.99.1.2
        - name: subnet2
          cidr: 99.99.2.0/28
          allocationRanges:
            - end: 99.99.2.14
              start: 99.99.2.2
        - name: subnet10
          cidr: 99.99.10.0/28
          allocationRanges:
            - end: 99.99.10.14
              start: 99.99.10.2
      bgpmainnetv6:
        - name: subnet0
          cidr: f00d:f00d:f00d:f00d:99:99::0/112
          allocationRanges:
            - end: f00d:f00d:f00d:f00d:99:99::1e
              start: f00d:f00d:f00d:f00d:99:99::2
        - name: subnet1
          cidr: f00d:f00d:f00d:f00d:99:99:1:0/112
          allocationRanges:
            - end: f00d:f00d:f00d:f00d:99:99:1:1e
              start: f00d:f00d:f00d:f00d:99:99:1:2
        - name: subnet2
          cidr: f00d:f00d:f00d:f00d:99:99:2:0/112
          allocationRanges:
            - end: f00d:f00d:f00d:f00d:99:99:2:1e
              start: f00d:f00d:f00d:f00d:99:99:2:2
        - name: subnet3
          cidr: f00d:f00d:f00d:f00d:99:99:10:0/112
          allocationRanges:
            - end: f00d:f00d:f00d:f00d:99:99:10:1e
              start: f00d:f00d:f00d:f00d:99:99:10:2
    bgpdefs:
      node3:
        bgpnet0:
          bgp_peer: "2620:cf::100:64:0:9"
          bgp_ip: "2620:cf::100:64:0:10"
        bgpnet1:
          bgp_peer: "2620:cf::100:65:0:9"
          bgp_ip: "2620:cf::100:65:0:10"
        routes:
          config:
            - destination: "f00d:f00d:f00d:f00d:99:99:0:0/96"
              next-hop-address: "2620:cf::100:64:0:9"
              next-hop-interface: enp8s0
              metric: 200
            - destination: "f00d:f00d:f00d:f00d:99:99:0:0/96"
              next-hop-address: "2620:cf::100:65:0:9"
              next-hop-interface: enp9s0
              metric: 201
            - destination: "2620:cf:cf:aaaa::0/64"
              next-hop-address: "2620:cf:cf:aaad::1"
              next-hop-interface: enp7s0
            - destination: "2620:cf:cf:aaab::0/64"
              next-hop-address: "2620:cf:cf:aaad::1"
              next-hop-interface: enp7s0
            - destination: "2620:cf:cf:aaac::0/64"
              next-hop-address: "2620:cf:cf:aaad::1"
              next-hop-interface: enp7s0
      node4:
        bgpnet0:
          bgp_peer: "2620:cf::100:64:1:9"
          bgp_ip: "2620:cf::100:64:1:10"
        bgpnet1:
          bgp_peer: "2620:cf::100:65:1:9"
          bgp_ip: "2620:cf::100:65:1:10"
        routes:
          config:
            - destination: "f00d:f00d:f00d:f00d:99:99:0:0/96"
              next-hop-address: "2620:cf::100:64:1:9"
              next-hop-interface: enp8s0
              metric: 200
            - destination: "f00d:f00d:f00d:f00d:99:99:0:0/96"
              next-hop-address: "2620:cf::100:65:1:9"
              next-hop-interface: enp9s0
              metric: 201
            - destination: "2620:cf:cf:aaaa::0/64"
              next-hop-address: "2620:cf:cf:aaad::1"
              next-hop-interface: enp7s0
            - destination: "2620:cf:cf:aaab::0/64"
              next-hop-address: "2620:cf:cf:aaad::1"
              next-hop-interface: enp7s0
            - destination: "2620:cf:cf:aaac::0/64"
              next-hop-address: "2620:cf:cf:aaad::1"
              next-hop-interface: enp7s0
      node5:
        bgpnet0:
          bgp_peer: "2620:cf::100:64:2:9"
          bgp_ip: "2620:cf::100:64:2:10"
        bgpnet1:
          bgp_peer: "2620:cf::100:65:2:9"
          bgp_ip: "2620:cf::100:65:2:10"
        routes:
          config:
            - destination: "f00d:f00d:f00d:f00d:99:99:0:0/96"
              next-hop-address: "2620:cf::100:64:2:9"
              next-hop-interface: enp8s0
              metric: 200
            - destination: "f00d:f00d:f00d:f00d:99:99:0:0/96"
              next-hop-address: "2620:cf::100:65:2:9"
              next-hop-interface: enp9s0
              metric: 201
            - destination: "2620:cf:cf:aaaa::0/64"
              next-hop-address: "2620:cf:cf:aaad::1"
              next-hop-interface: enp7s0
            - destination: "2620:cf:cf:aaab::0/64"
              next-hop-address: "2620:cf:cf:aaad::1"
              next-hop-interface: enp7s0
            - destination: "2620:cf:cf:aaac::0/64"
              next-hop-address: "2620:cf:cf:aaad::1"
              next-hop-interface: enp7s0
      node6:
        bgpnet0:
          bgp_peer: 100.64.10.1
          bgp_ip: 100.64.10.2
        bgpnet1:
          bgp_peer: "2620:cf::100:64:10:1"
          bgp_ip: "2620:cf::100:64:10:2"
        routes:
          config:
            - destination: 192.168.133.0/24
              next-hop-address: 100.64.10.1
              next-hop-interface: enp8s0
    net-attach-def:
      node6: |
        {
          "cniVersion": "0.3.1",
          "name": "bgpnet-worker-3",
          "type": "macvlan",
          "master": "enp8s0",
          "ipam": {
            "type": "whereabouts",
            "range": "100.64.10.0/24",
            "range_start": "100.64.10.10",
            "range_end": "100.64.10.19",
            "routes": [
              {
                "dst": "192.168.133.0/24",
                "gw": "100.64.10.1"
              },
              {
                "dst": "10.0.0.0/8",
                "gw": "100.64.10.1"
              }
            ]
          }
        }

  loopback:
    prefix-length: 32
    prefix-length-ipv6: 128
    iface: lo
  datacentre:
    net-attach-def: |
      {
        "cniVersion": "0.3.1",
        "name": "datacentre",
        "type": "bridge",
        "bridge": "ospbr",
        "ipam": {}
      }

  dns-resolver:
    config:
      server:
        - "2620:cf:cf:aaad::1"
      search: []
    options:
      - key: server
        values:
          - "2620:cf:cf:aaad::1"

  routes:
    config: []

  rabbitmq:
    endpoint_annotations:
      metallb.universe.tf/address-pool: internalapi
      metallb.universe.tf/loadBalancerIPs: "2620:cf:cf:bbbb::85"
  rabbitmq-cell1:
    endpoint_annotations:
      metallb.universe.tf/address-pool: internalapi
      metallb.universe.tf/loadBalancerIPs: "2620:cf:cf:bbbb::86"

  lbServiceType: LoadBalancer
  storageClass: local-storage
  bridgeName: ospbr
